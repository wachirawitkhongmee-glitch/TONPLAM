<!DOCTYPE html>
<html lang="th">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡∏î‡∏π</title>
    <link rel="stylesheet" href="style.css">
</head>

<body class="bg-cartoon">

    <div class="page" style="margin: 0 auto;">

        <div class="top-bar">
            <div class="app-title" style="font-size: 1.5rem; color: #FF6F61;">‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡∏î‡∏π üìú</div>
        </div>

        <div id="list" style="margin-bottom: 20px;"></div>

        <button class="cartoon-btn secondary" onclick="history.back()">üîô ‡∏Å‡∏•‡∏±‡∏ö</button>
    </div>

    <script>
        let u = localStorage.getItem("currentUser");
        // Try both keys for compatibility or logic fix
        let h_user = JSON.parse(localStorage.getItem("history_" + u) || "[]");
        let h_global = JSON.parse(localStorage.getItem("history") || "[]");

        // Prefer user specific history if available, else global
        let h = h_user.length > 0 ? h_user : h_global;

        let box = document.getElementById("list");

        if (h.length == 0) {
            box.innerHTML = "<div class='cartoon-card'><p>‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡∏î‡∏π‡∏à‡πâ‡∏≤</p></div>";
        } else {
            h.forEach(x => {
                box.innerHTML += `<div class="cartoon-card" style="margin-bottom: 10px; padding: 15px; text-align: left;">‚Ä¢ ${x}</div>`;
            });
        }

        if ("serviceWorker" in navigator) {
            navigator.serviceWorker.register("service-worker.js");
        }
    </script>
</body>

</html>